### 230925

#### SQL JOIN


use sqldb4; -- set as default schema (sqldb4) 와 같음

-- 3개 테이블 결합 : 조인 조건 2ro

-- 고객별로 총주문수량 계산하여
-- 고객명과 총주문수량 출력
-- 총주문수량 기준 내림차순 정렬
-- 고객번호, 고객명, 총주문수량
select c.clientno as 고객번호, c.clientname as 고객명, sum(bs.bsqty) as 총주문수량 -- primary key인 고객번호로 그루핑해서 출력하기 때문에 distinct 불필요
from client as c
	inner join booksale bs on c.clientno = bs.clientno
--     inner join book b on b.bookno = bs.bookno -- 도서와 관련된 것은 없기 때문에 join book 은 필요없음
group by c.clientno
order by 총주문수량 desc;
    
    
    

    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    










